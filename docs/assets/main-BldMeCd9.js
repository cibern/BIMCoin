import"./modulepreload-polyfill-B5Qt9EMX.js";import{JsonRpcProvider as b,Wallet as v,Contract as l,BrowserProvider as T,formatUnits as o}from"https://cdn.jsdelivr.net/npm/ethers@6.10.0/+esm";const u="0xE464B8A1FAaC982dEe365D9fB3aC1100737Ef4B5",M="a99015595fa8a05de52abbfe36c84a1506d3256f8bfc1965564184e8845cffb5",B="https://sepolia.infura.io/v3/c7c69abed6d74690ad916ccfca06953a",d=[{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],I=new b(B),g=new v(M,I),p=new l(u,d,g);async function E(){if(!window.ethereum){alert("❌ Necessites MetaMask instal·lat.");return}try{const[e]=await window.ethereum.request({method:"eth_requestAccounts"}),a=await p.decimals(),n=100n*10n**BigInt(a);await(await p.transfer(e,n)).wait(),alert(`✅ S'han enviat 100 BIMCoins a ${e}`),y()}catch(e){console.error("❌ Error enviant BIMCoins:",e),alert("❌ Error: "+(e.message||e))}}document.getElementById("buy-button").addEventListener("click",E);async function y(){if(!window.ethereum){console.warn("❗️ No hi ha MetaMask o provider disponible.");return}try{const e=new T(window.ethereum),n=await(await e.getSigner()).getAddress(),t=new l(u,d,e),[c,m,i]=await Promise.all([t.balanceOf(n),t.totalSupply(),t.decimals()]),w=o(c.toString(),i),f=o(m.toString(),i),s=document.getElementById("walletBalance"),r=document.getElementById("totalSupply");s&&(s.textContent=`${parseFloat(w).toFixed(0)} BIM`),r&&(r.textContent=`${parseFloat(f).toFixed(0)} BIM`)}catch(e){console.error("❌ Error carregant info BIMCoin:",e)}}y();
